<header class="calendar-header">
  <div class="calendaria-hud-search-panel{{#if searchOpen}} visible{{/if}}">
    <div class="search-panel-header">
      <input type="search" class="search-input" name="search" placeholder="{{localize 'CALENDARIA.Search.Placeholder'}}"
        value="{{searchTerm}}" autocomplete="off">
    </div>
    <div class="search-panel-results">
      {{#if searchResults.length}}
        {{#each searchResults}}
          <div class="search-result-item" data-action="openSearchResult" data-id="{{id}}"
            data-journal-id="{{data.journalId}}">
            <span class="result-name">{{name}}</span>
            {{#if description}}<span class="result-description">{{description}}</span>{{/if}}
          </div>
        {{/each}}
      {{else if searchTerm}}
        <div class="no-results">
          <i class="fas fa-search"></i>
          <span>{{localize "CALENDARIA.Search.NoResults"}}</span>
        </div>
      {{/if}}
    </div>
  </div>

  <div class="calendar-actions">
    <button type="button" data-action="toggleCompact" data-tooltip
      aria-label="{{localize 'CALENDARIA.CalendarApp.ToggleCompact'}}" class="toggle-compact-btn">
      <i class="fas fa-compress"></i>
    </button>

    <button type="button" data-action="openSettings" data-tooltip
      aria-label="{{localize 'CALENDARIA.HUD.Settings.Name'}}" class="settings-btn">
      <i class="fas fa-gear"></i>
    </button>

    <button type="button" class="search-toggle" data-action="toggleSearch" data-tooltip
      aria-label="{{localize 'CALENDARIA.Common.SearchNotes'}}">
      <i class="fas fa-search"></i>
    </button>

    <button type="button" data-action="today" data-tooltip aria-label="{{localize 'CALENDARIA.CalendarApp.GoToToday'}}">
      <i class="fas fa-calendar-day"></i> {{localize 'CALENDARIA.Common.Today'}}
    </button>

    {{#if canAddNotes}}
      <button type="button" data-action="addNoteToday" data-tooltip
        aria-label="{{localize 'CALENDARIA.CalendarApp.AddNoteToday'}}" class="add-note-today-btn">
        <i class="fas fa-plus"></i> {{localize 'CALENDARIA.Common.AddNote'}}
      </button>
    {{/if}}

    {{#if editable}}
      <button type="button" data-action="setAsCurrentDate" data-tooltip
        aria-label="{{#if isToday}}{{localize 'CALENDARIA.CalendarApp.CurrentDateBtn'}}{{else}}{{localize 'CALENDARIA.CalendarApp.SetAsCurrent'}}{{/if}}"
        class="set-current-date-btn" {{#if isToday}}disabled{{/if}}>
        <i class="fas fa-calendar-check"></i>
        {{#if isToday}}{{localize 'CALENDARIA.CalendarApp.CurrentDateBtn'}}{{else}}{{localize 'CALENDARIA.CalendarApp.SetAsCurrentBtn'}}{{/if}}
      </button>
    {{/if}}

    {{!-- Custom widget actions insertion point --}}
    {{{widgets.actions}}}

    <div class="view-selector">
      <button type="button" data-action="changeView" data-mode="month"
        class="{{#if (eq displayMode 'month')}}active{{/if}}">
        {{localize 'CALENDARIA.Common.Month'}}
      </button>
      <button type="button" data-action="changeView" data-mode="week"
        class="{{#if (eq displayMode 'week')}}active{{/if}}">
        {{localize 'CALENDARIA.Common.Week'}}
      </button>
      <button type="button" data-action="changeView" data-mode="year"
        class="{{#if (eq displayMode 'year')}}active{{/if}}">
        {{localize 'CALENDARIA.Common.Year'}}
      </button>
    </div>
  </div>
</header>
